---
title: "3.2. Branches and Tags mapping"
category: subchapter
booktype: remote
weight: 5
---
###3.2. Branches and Tags mapping

In this chapter we're going to look into various cases regarding branches and tags mapping that may occur during the work with the add-on.

For each project mapped to a Git repository, branches and tags are mapped to the corresponding references in the Git repository. SubGit distinguishes the following folders in Subversion project as branches or tags:

+ trunk folder
+ folders in the dedicated branches folder
+ folders in the dedicated shelves folder
+ folders in the dedicated tags folder

Shelves are special kind of branches used by SubGit to represent Git anonymous branches in Subversion repository.

Each folder is mapped to the reference (branch or tag) in the Git repository. For trunk folder the mapping is one-to-one as there could be only one trunk folder (as well as only one master reference in Git) and for other folders wildcard mapping is used. 

**Default Branches and Tags Mapping**

    url = https://host/svn/alice
    trunk = trunk:refs/heads/master
    branches = branches/*:refs/heads/*
    tags = tags/*:refs/tags/*
    shelves = shelves/*:refs/shelves/*

When the branch **foo** is translated the same log message both at SVN and Git repository will appear.

Due to having tags mapping line in your configuration file, all tags you create in your Git repository would be copied to SVN repository.

    [git]

    $> git tag 1.1
    $> git push origin 1.1

    
    [svn]

    $> svn log -g https://host/svn/alice
    
    ------------------------------------------------------------------------
    r18 | alice | 1 line

    Tag '/tags/1.1' created from /trunk:17

**There is only trunk based in the root**

It's often the case, when there is no branches and project is based in the root of repository. It's possible to have the configuration file set this way:

    url = https://host/svn/alice
    trunk = trunk:refs/heads/master

Output of **svn log http://host/repo** command and **git log master** command should be the same.
Since there is no branch or shelves mapping, if you create a branch in your git repository, it will not be translated to SVN.

    [git]

    $> git checkout -b bar
    
    Switched to a new branch 'bar'

The branch **bar** was created
    
    $> echo "substantial change of readme file" > README.rdoc 
    
    $> git commit -am "substantial change of readme”
    
    [bar 4d6a8] substantial change of readme
     1 file changed, 1 insertion(+), 1 deletions(-)

The changes were made and commited.
    
    $> git checkout master
    
    $> echo "important change" > Rakefile 
    
    $> git commit -am "important change"
    
    [master ad03078] important change
     1 file changed, 1 insertion(+), 1 deletion(-)

    $> git merge bar master
    
    $> git push origin

Also changes in master were made so merge commit was created.

This is what was happens in SVN repository:

    [svn]

    $> svn log https://host/svn/alice
    
    ------------------------------------------------------------------------
    r25 | alice | 1 line

    important change
    ------------------------------------------------------------------------
    r24 | alice | 1 line

    Merge branch 'bar'
    ------------------------------------------------------------------------
    r23 | alice | 1 line

    substantial change of readme

More details on this matter you will find in the chapter describing **Shelves**

**Tricky names**

SubGit is working well with almost any layout. 

Whenever project uses standard folder names (i.e. trunk, branches and tags), SubGit would automatically detect and configure mapping for that project. Otherwise configuration would have to be manually adjusted to include proper paths and references names.

Wildcard branches and tags mappings could also be used to define correspondence between set of Subversion directories that represent branches or tags and corresponding Git references.

Wildcard related mapping syntax rules:

+ Each mapping could include zero or more "\*" on both sides (sides are separated by ":") of the definition
+ Each path or namespace segment should contain no more than one "\*"
+ Number of "\*" on the left side of the mapping must be equal to the number of "\*" on the right side of it

Take for example a comlicated layout like this:

    http://host/repo/trunk
    http://host/repo/release_X
    http://host/repo/release_Y
    http://host/repo/release_Z
    http://host/repo/fixbox/alex/bar
    http://host/repo/fixbox/alice/baz

Configuration file would be looking like this in that case:

    url = https://host/svn/alice
    trunk = trunk:refs/heads/master
    branches = release_*:refs/heads/release/*
    branches = fixbox/*/*:refs/heads/fixbox/*/*
    
Please note, that to Git repository it will be translated as **release/X**, corresponding to the config file

    [git]

    $> git pull

     * [new branch]      fixbox/alex/bar -> origin/fixbox/alex/bar
     * [new branch]      release/X  -> origin/release/X

They are supposed to be used just as the any branch, except **release/X** branch translates to SVN as branch named **release_X**.

    [git]

    $> git checkout release/X
    
    $> echo "test" > file.txt 
    
    $> git commit -am "test release/X 1"
    
    [release/X f65b9] test release/X 1
     1 file changed, 1 insertion(+), 1 deletion(-)
    
    $> git push origin release/X

Branch **release/X** was created, changes were made, commited and pushed.
This is how it will appear in the log of corresponding SVN repository:

    [svn]

    $> svn log https://host/svn/alice/release_X
    ------------------------------------------------------------------------
    r55 | alice | 1 line

    test release/X 1

Also if a new branch was created in git and named e.g **release/AB**, it will be translated to the SVN repository as branch named **release_AB**


**Changing layout already having the working mirror**

It is possible that at some point it would become nescessary to change layout config for the mirror that is already working.

There is a mirror with the default layout:

    url = https://host/svn/alice
    trunk = trunk:refs/heads/master
    branches = branches/*:refs/heads/*
    tags = tags/*:refs/tags/*
    shelves = shelves/*:refs/shelves/*

If branches are added to configuration file that already exist (or existed ever before) in SVN repository

    url = https://host/svn/alice
    trunk = trunk:refs/heads/master
    branches = release_*:refs/heads/release/*

and the command **subgit install** is ran, the installation will fail with following message:

    [subgit]

    $> subgit install .

    SubGit version 3.0.0 ('Bobique') build #3316

    About to shut down background translation process.
    Background translation process is not running.

    INSTALLATION FAILED

    error: Unable to activate configuration file '/Users/katedrozdovsky/Documents/Projects/tmate_ex/ktmate.git/subgit/config':
    error: The following new mappings have been removed from [svn] section:
    error:    release_*:refs/heads/release/*
    error:    fixbox/*/*:refs/heads/fixbox/*/*
    error: Only branches that are not yet present in Subversion history could be removed.
    error: Revert these deletions and run 'install' command, or force rebuild with '--rebuild' option.


In this case it's better to rename the branch in configuration file, as the **--rebuild** option is one extremely drastic measure.

If there was no such branch in SVN repository, it will be created, and you will be able to work with it as with a usual branch.

    [subgit]

    $> subgit install .

    SubGit version 3.0.0 ('Bobique') build #3316

    About to shut down background translation process.
    Background translation process is not running.

    Translating Subversion revisions to Git commits...

        Subversion revisions translated: 56.
        Total time: 90 seconds.

    INSTALLATION SUCCESSFUL

If there is a branch with the specific name space, that exists only in your Git repository, like that:

   $> git checkout -b nice/branch

(created new branch in git using namespace **nice/**)
 
    $> echo "nice change" >> file.txt
    
    $> git commit -am "nice change"
      
    $> git push origin nice/branch

(changes were made, commited and pushed)

and you want to get it in the SVN repository, all you have to do is to add this namespace to your configuration file, for example, like this: 

    branches = branches/nice/branch:refs/heads/nice/branch
    
and run **subgit install**. It will become available in your SVN repository after that:

    [svn]

    $> svn log https://host/svn/alice/branches/nice/branch
    
    ------------------------------------------------------------------------
    r57 | alice | 1 line

    nice change

Congratulations! Now you are a Subgit branch expert.
[](#up)